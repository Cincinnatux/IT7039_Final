{% extends 'base.html' %}

{% block head %}
<!--Enter <head> code here-->
<title>Whiskey Flight Randomizer</title>
<!-- Include Bootstrap CSS for styling (optional) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
{% endblock %} 

{% block body %}
<!--Enter <body> code here-->
<div id="grid">
    <header class="box header">
        <h1>Get Assigned a Random Flight!</h1>
    </header>
    <nav class="box mobile-nav">
        <a href="{{ url_for('home') }}">Home Page</a>
        <a href="{{ url_for('final' )}}">Enter New Bottle</a>
        <a href="{{ url_for('random_flight') }}">Get a Random Flight</a>
        <a href="{{ url_for('analyze_inventory' )}}">Analyze Current Bottles</a>
    </nav>
    <main class="box main">
        <div class="container">
            <h2>Random Flight</h2>
            <button id="fetch-flight" class="btn btn-primary">Get Random Flight</button>
            <div id="flight-info" class="mt-3"></div>
        </div>
        
        <script>
            document.getElementById('fetch-flight').addEventListener('click', function() {
                fetch('{{ url_for("get_random_flight") }}')
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            const bottles = data.bottles;
                            let html = '<ul style="list-style-type:none;">';
                            bottles.forEach(bottle => {
                                html += `<li>${bottle.expression} - ${bottle.brand_name}</li>`;
                            });
                            html += '</ul>';
                            document.getElementById('flight-info').innerHTML = html;
                        } else {
                            document.getElementById('flight-info').innerHTML = `<p>${data.message}</p>`;
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching flight:', error);
                        document.getElementById('flight-info').innerHTML = '<p>An error occurred while fetching the flight.</p>';
                    });
            });
        </script>
    </main>
    <nav class="box desktop-nav">
        <a href="{{ url_for('home') }}">Home Page&nbsp;&nbsp;&nbsp;&nbsp;</a>
        <a href="{{ url_for('final' )}}">Enter New Bottle&nbsp;&nbsp;&nbsp;&nbsp;</a>
        <a href="{{ url_for('random_flight') }}">Get a Random Flight&nbsp;&nbsp;&nbsp;&nbsp;</a>
        <a href="{{ url_for('analyze_inventory' )}}">Analyze Current Bottles&nbsp;&nbsp;&nbsp;&nbsp;</a>
    </nav>
    <aside class="box aside"></aside>
    <footer class="box footer"></footer>
</div>
{% endblock %} 